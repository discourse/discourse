#!/bin/bash
# Chrome wrapper that links to Playwright's Chromium

PLAYWRIGHT_BASE="/home/discourse/.cache/ms-playwright"
CHROMIUM_PATTERN="chromium_headless_shell-*"
CHROMIUM_PATH=""

# Look for any chromium_headless_shell directory
for chromium_dir in "$PLAYWRIGHT_BASE"/$CHROMIUM_PATTERN; do
    if [ -d "$chromium_dir" ]; then
        CHROMIUM_PATH="$chromium_dir/chrome-linux/headless_shell"
        if [ -f "$CHROMIUM_PATH" ] && [ -x "$CHROMIUM_PATH" ]; then
            break
        fi
    fi
done

if [ -n "$CHROMIUM_PATH" ] && [ -f "$CHROMIUM_PATH" ] && [ -x "$CHROMIUM_PATH" ]; then
    exec "$CHROMIUM_PATH" "$@"
else
    echo "No Chrome/Chromium found at expected location: $PLAYWRIGHT_BASE/$CHROMIUM_PATTERN"
    exit 1
fi

