/*
  This CSS file is loaded dynamically when loadDevTools() is run in the console.
  It is not part of our normal CSS build process, so SCSS variables are not available.
  Native CSS nesting can be used safely, because developers who use this tool are expected to have modern browsers.
*/

:root {
  /* Colors by usage */
  --dev-tools-plugin-outlet-color: #16a34a;
  --dev-tools-plugin-outlet-hover-color: #15803d;
  --dev-tools-wrapper-outlet-color: #2563eb;
  --dev-tools-wrapper-outlet-hover-color: #1d4ed8;
  --dev-tools-block-color: #d97706;
  --dev-tools-block-hover-color: #b45309;
  --dev-tools-ghost-color: #dc2626;
  --dev-tools-ghost-hover-color: #b91c1c;
  --dev-tools-block-outlet-color: #f59e0b;

  /* Shared values */
  --dev-tools-badge-font-size: 0.75rem;
  --dev-tools-badge-padding: 2px 5px;
  --dev-tools-badge-radius: 0 0 4px 0;
  --dev-tools-shadow: 1px 1px 2px rgb(0 0 0 / 0.5);
  --dev-tools-bg-opacity: 0.05;
  --dev-tools-container-margin: 2px;
  --dev-tools-mono-font:
    "Courier New", courier, "Lucida Console", monaco, monospace;
}

/* Dev Tools Toolbar */
.dev-tools-toolbar {
  position: fixed;
  z-index: 999999;
  display: flex;
  flex-direction: column;
  background-color: var(--primary-200);
  border-radius: 0 5px 5px 0;
  box-shadow: var(--dev-tools-shadow);
  opacity: 0.8;
  transition: opacity 0.2s ease-in-out;

  &.--dragging {
    opacity: 0.5;
  }

  button {
    background: none;
    border: none;
    padding: 5px;
    color: var(--primary-700);

    .d-icon {
      color: inherit !important;
    }

    &:hover:not(.gripper) {
      background-color: var(--primary-50);
    }

    &.gripper {
      cursor: grab;
      padding-block: 0;
      border-bottom: 1px dotted var(--primary-low-mid);
      color: var(--primary-500);
    }

    &.--active {
      background-color: var(--primary-100);
      color: var(--tertiary);

      .d-icon {
        font-weight: bold;
      }
    }
  }
}

/* Shared Base Styles */

/* Base styles for all debug container boundaries */
.plugin-outlet-debug,
.block-debug-info,
.block-debug-ghost,
.block-outlet-debug {
  position: relative;
  margin: var(--dev-tools-container-margin);
}

/* Base styles for all debug badges */
.plugin-outlet-debug__badge,
.block-debug-badge,
.block-debug-ghost__badge,
.block-outlet-debug__badge {
  position: absolute;
  top: -1px;
  left: -1px;
  z-index: 1000;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  color: white !important;
  padding: var(--dev-tools-badge-padding) !important;
  font-size: var(--dev-tools-badge-font-size) !important;
  font-weight: bold;
  border-radius: var(--dev-tools-badge-radius);
  cursor: pointer;
  text-shadow: var(--dev-tools-shadow);

  .d-icon {
    color: white !important;
    font-size: var(--dev-tools-badge-font-size) !important;
    font-weight: bold;
    width: var(--dev-tools-badge-font-size) !important;
    filter: drop-shadow(var(--dev-tools-shadow));
  }
}

/* Plugin Outlet Debug */
.plugin-outlet-debug {
  border: 1px dashed var(--dev-tools-plugin-outlet-color);
  background: rgb(22 163 74 / var(--dev-tools-bg-opacity));

  /* Wrapper outlets are compact inline markers */
  &.--wrapper {
    border: none;
    background: none;

    .plugin-outlet-debug__badge {
      position: static;
      background: var(--dev-tools-wrapper-outlet-color);
      border-radius: 4px;

      &:hover {
        background: var(--dev-tools-wrapper-outlet-hover-color);
      }
    }
  }
}

.plugin-outlet-debug__badge {
  background: var(--dev-tools-plugin-outlet-color);

  &:hover {
    background: var(--dev-tools-plugin-outlet-hover-color);
  }
}

/* Plugin Outlet Info Popup */
.plugin-outlet-info__wrapper {
  display: flex;
  flex-direction: column;
}

.plugin-outlet-info__heading {
  font-size: 14px;
  font-weight: bold;
  margin-bottom: 10px;
  display: flex;
  gap: 5px;

  .title {
    flex-grow: 1;
  }

  .github-link {
    color: var(--primary-medium);
  }
}

.plugin-outlet-info__content {
  display: grid;
  grid-template-columns: min-content 1fr;
  font-size: 14px;
  gap: 10px;
  min-width: 300px;
  max-width: 100%;
  width: 100%;
  overflow: hidden;

  & > div {
    min-width: 0;
  }

  .fw {
    font-family: var(--dev-tools-mono-font);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    background: var(--primary-very-low);
  }

  .value {
    display: flex;
    gap: 5px;
  }

  .no-arguments {
    grid-column: span 2;
  }

  a {
    color: var(--primary-medium);
  }
}

/* Block Debug Overlay */
.block-debug-info {
  border: 1px dotted var(--dev-tools-block-color);
  background: rgb(217 119 6 / var(--dev-tools-bg-opacity));

  &.--rendered {
    border-color: var(--dev-tools-block-color);
  }
}

.block-debug-badge {
  background: var(--dev-tools-block-color);

  &:hover {
    background: var(--dev-tools-block-hover-color);
  }
}

/* Ghost blocks (hidden/failed conditions) */
.block-debug-ghost {
  border: 1px dashed var(--dev-tools-ghost-color);
  background: repeating-linear-gradient(
    45deg,
    transparent,
    transparent 10px,
    rgb(220 38 38 / var(--dev-tools-bg-opacity)) 10px,
    rgb(220 38 38 / var(--dev-tools-bg-opacity)) 20px
  );
  padding: 8px;
  min-height: 30px;
}

.block-debug-ghost__badge {
  background: var(--dev-tools-ghost-color);

  &:hover {
    background: var(--dev-tools-ghost-hover-color);
  }
}

/* Block Outlet boundaries */
.block-outlet-debug {
  border: 1px dashed var(--dev-tools-block-outlet-color);
  padding: 4px;
  min-height: 20px;
  background: rgb(245 158 11 / var(--dev-tools-bg-opacity));
}

.block-outlet-debug__badge {
  background: var(--dev-tools-block-outlet-color);
}

/* Block Debug Tooltip */
.block-debug-tooltip {
  display: flex;
  flex-direction: column;
  gap: 12px;
  font-size: 13px;
  min-width: 280px;
  max-width: 450px;

  &.--ghost {
    .block-debug-tooltip__header {
      color: #f44336;
    }
  }
}

.block-debug-tooltip__header {
  display: flex;
  align-items: center;
  gap: 6px;
  font-weight: bold;
  color: var(--dev-tools-block-color);

  &.--failed {
    color: var(--dev-tools-ghost-color);
  }

  .d-icon {
    font-size: var(--dev-tools-badge-font-size) !important;
  }
}

.block-debug-tooltip__title {
  font-size: 14px;
}

.block-debug-tooltip__outlet {
  font-weight: normal;
  font-size: 11px;
  opacity: 0.7;
}

.block-debug-tooltip__status {
  font-size: 10px;
  padding: 1px 4px;
  background: var(--dev-tools-ghost-color);
  color: white;
  border-radius: 2px;
}

.block-debug-tooltip__section {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.block-debug-tooltip__section-title {
  font-size: 11px;
  font-weight: bold;
  text-transform: uppercase;
  opacity: 0.6;
}

.block-debug-tooltip__empty {
  font-style: italic;
  opacity: 0.6;
}

.block-debug-tooltip__hint {
  font-size: 11px;
  font-style: italic;
  opacity: 0.7;
  border-top: 1px solid var(--primary-low);
  padding-top: 8px;
}

/* Block Debug Args Table */
.block-debug-args {
  display: flex;
  flex-direction: column;
  gap: 4px;

  &.--empty {
    font-style: italic;
    opacity: 0.6;
  }
}

.block-debug-args__row {
  display: flex;
  gap: 8px;
  padding: 2px 4px;
  border-radius: 2px;
  cursor: pointer;
  background: none;
  border: none;
  width: 100%;
  text-align: left;
  font: inherit;
  color: inherit;

  &:hover {
    background: var(--primary-very-low);
  }
}

.block-debug-args__key {
  font-weight: bold;
  color: #2196f3;
  white-space: nowrap;
}

.block-debug-args__value {
  font-family: var(--dev-tools-mono-font);
  font-size: 12px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex: 1;
}

.block-debug-args__type {
  font-size: 10px;
  opacity: 0.5;
  margin-right: 4px;
}

/* Block Debug Conditions Tree */
.block-debug-conditions {
  display: flex;
  flex-direction: column;
  gap: 2px;
  font-family: var(--dev-tools-mono-font);
  font-size: 12px;

  &.--passed {
    .block-debug-condition__type {
      color: var(--dev-tools-block-color);
    }
  }

  &.--failed {
    .block-debug-condition__type {
      color: var(--dev-tools-ghost-color);
    }
  }
}

.block-debug-condition {
  display: flex;
  align-items: center;
  gap: 4px;

  &.--combinator {
    .block-debug-condition__type {
      font-weight: bold;
    }
  }
}

.block-debug-condition__type {
  &.--combinator {
    color: #607d8b;
  }
}

.block-debug-condition__args {
  opacity: 0.7;
  font-size: 11px;
}

/* Block Debug Menu (dropdown button) */
.block-debug-menu {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 8px;
  min-width: 160px;

  label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    font-size: 13px;

    &:hover {
      color: var(--primary);
    }

    input[type="checkbox"] {
      margin: 0;
    }
  }
}
