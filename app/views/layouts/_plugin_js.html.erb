<%# locals: (opts:) %>

<%- Discourse.find_plugin_js_assets(opts).tap do |plugin_assets| %>
  <%- plugin_assets.each do |asset| %>
    <%= preload_script asset[:name], attrs: {
          "data-discourse-plugin": asset[:plugin]&.metadata&.name,
          "data-preinstalled": asset[:plugin] && !File.exist?(File.join(asset[:plugin].directory, ".git")),
          "data-official": asset[:plugin]&.metadata&.official?,
        }.compact %>
  <%- end %>
<%- end %>
