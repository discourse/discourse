<div class="timeline-container">
  <DSection
    @class={{concat "topic-timeline " this.class}}
    @loading={{@model.postStream.loading}}
    @dockAt={{@dockAt}}
    @dockBottom={{@dockBottom}}
  >

    <div class="timeline-controls">
      {{#if (and (not @info.topicProgressExpanded) this.currentUser)}}
        <TopicAdminMenuButton
          @topic={{@model}}
          @addKeyboardTargetClass={{true}}
          @toggleMultiSelect={{@toggleMultiSelect}}
          @showTopicSlowModeUpdate={{@showTopicSlowModeUpdate}}
          @deleteTopic={{@deleteTopic}}
          @recoverTopic={{@recoverTopic}}
          @toggleClosed={{@toggleClosed}}
          @toggleArchived={{@toggleArchived}}
          @toggleVisibility={{@toggleVisibility}}
          @showTopicTimerModal={{@showTopicTimerModal}}
          @showFeatureTopic={{@showFeatureTopic}}
          @showChangeTimestamp={{@showChangeTimestamp}}
          @resetBumpDate={{@resetBumpDate}}
          @convertToPublicTopic={{@convertToPublicTopic}}
          @convertToPrivateMessage={{@convertToPrivateMessage}}
        />
      {{/if}}
    </div>

    <TopicTimeline::ScrollArea
      @topic={{@model}}
      @enteredIndex={{this.enteredIndex}}
      @jumpTop={{@jumpTop}}
      @jumpBottom={{@jumpBottom}}
      @jumpEnd={{@jumpEnd}}
      @jumpToIndex={{@jumpToIndex}}
      @fullscreen={{@fullscreen}}
    />

    <div class="timeline-footer-controls">
      {{#if (and this.siteSettings.summary_timeline_button @topic.has_summary (not (and @fullscreen @topic.postStream.summary)))}}
        <button type="button" class="show-summary btn-small" label={{i18n "summary.short_label"}} title={{i18n "summary.short_title"}} {{on "click" @showSummary}}>
          {{d-icon "layer-group"}}
        </button>
      {{/if}}

      {{#if (and this.currentUser (not @fullscreen))}}
        {{#if this.canCreatePost}}
          <button type="button" class="btn btn-default create reply-to-post no-text btn-icon" title={{i18n "topic.reply.help"}} {{on "click" (fn @replyToPost null)}}>
            {{d-icon "reply"}}
          </button>
        {{/if}}
      {{/if}}

      {{#if @fullscreen}}
        <button
          type="button"
          class="jump-to-post"
          title={{i18n "topic.progress.jump_prompt_long"}}
          label={{i18n "topic.progress.jump_prompt"}}
          {{on "click" @jumpToPostPrompt}}
        />
      {{/if}}

      {{#if this.currentUser}}
        <TopicNotificationsButton
          @notificationLevel={{@model.details.notification_level}}
          @topic={{@model}}
          @showFullTitle={{false}}
          @appendReason={{false}}
          @placement={{"bottom-end"}}
          @mountedAsWidget={{true}}
          @showCaret={{false}}
        />
        {{#if this.site.mobileView}}
          <TopicAdminMenuButton @topic={{@topic}} @addKeyboardTargetClass={{true}} @openUpwards={{true}} />
        {{/if}}
      {{/if}}
    </div>
  </DSection>
</div>
